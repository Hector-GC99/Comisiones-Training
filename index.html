<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Esquema de Comisiones - Ejecutivos Training</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Century+Gothic&display=swap');

        :root {
            /* Define variables CSS globales para colores. */
            --teal-dark: #004d4d;
            /* Azul verdoso oscuro. */
            --teal: #008080;
            /* Azul verdoso estándar. */
            --aqua: #40E0D0;
            /* Aguamarina. */
            --mint: #98FF98;
            /* Menta. */
            --mint-light: #F0FFF4;
            /* Menta muy claro. */
            --white: #ffffff;
            /* Blanco. */
            --gray-bg: #e0f2f1;
            /* Fondo grisáceo verdoso claro. */
            --red-retention: #ff0000;
            /* Rojo puro para retención/chargeback. */
        }

        * {
            box-sizing: border-box;
        }

        /* Aplica el modelo de caja border-box a todos los elementos. */

        body {
            /* Estilos para el cuerpo de la página. */
            background-color: var(--gray-bg);
            /* Color de fondo del body. */
            display: flex;
            /* Habilita el layout flexbox. */
            flex-direction: column;
            /* Organiza los elementos verticalmente. */
            align-items: center;
            /* Centra los elementos horizontalmente. */
            margin: 0;
            /* Elimina el margen por defecto. */
            padding: 20px;
            /* Relleno alrededor del contenido. */
            font-family: 'Century Gothic', sans-serif;
            /* Establece la fuente principal. */
            color: var(--teal-dark);
            /* Color de texto principal. */
            gap: 40px;
            /* Espacio entre los slides. */
        }

        /* Botón descarga */
        /* Comentario para el botón de descarga. */
        .download-btn {
            /* Estilos para el botón de descarga fijo. */
            position: fixed;
            bottom: 20px;
            right: 20px;
            /* Posición fija en la esquina inferior derecha. */
            background: var(--teal-dark);
            color: white;
            /* Color de fondo y texto. */
            padding: 15px 25px;
            border-radius: 50px;
            /* Relleno y bordes redondeados (píldora). */
            text-decoration: none;
            font-weight: bold;
            /* Decoración y peso de la fuente. */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            /* Sombra para efecto de elevación. */
            border: 2px solid var(--aqua);
            cursor: pointer;
            /* Borde y cursor. */
            z-index: 1000;
            transition: 0.3s;
            /* Asegura que esté encima de otros elementos y añade transición. */
        }

        .download-btn:hover {
            background: var(--teal);
            transform: scale(1.05);
        }

        /* Efecto hover: cambia color y escala. */

        .slide-container {
            /* Contenedor principal de cada 'slide' de la presentación. */
            align-items: center;
            /* Centra el contenido verticalmente. */
            background-color: var(--white);
            /* Fondo blanco. */
            display: flex;
            /* Habilita flexbox. */
            flex-direction: column;
            /* Elementos internos en columna. */
            height: 720px;
            /* Altura fija del slide. */
            justify-content: flex-start;
            /* Alinea contenido al inicio (arriba). */
            overflow: hidden;
            /* Oculta contenido que se desborde. */
            position: relative;
            /* Establece contexto para posicionamiento absoluto. */
            width: 1280px;
            /* Ancho fijo del slide (típico de presentación 16:9). */
            box-shadow: 0 15px 35px rgba(0, 128, 128, 0.15);
            /* Sombra elegante. */
            border-radius: 12px;
            /* Bordes redondeados. */
            flex-shrink: 0;
            /* Evita que el contenedor se encoja. */
        }

        /* Blobs Fondo */
        /* Comentario para los elementos de fondo decorativos (blobs). */
        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            z-index: 0;
            opacity: 0.1;
        }

        /* Estilos base para los blobs: círculo, desenfoque. */
        .blob-1 {
            top: -100px;
            right: -100px;
            width: 500px;
            height: 500px;
            background: var(--aqua);
        }

        /* Posicionamiento y color del blob superior derecho. */
        .blob-2 {
            bottom: -50px;
            left: -50px;
            width: 400px;
            height: 400px;
            background: var(--teal);
        }

        /* Posicionamiento y color del blob inferior izquierdo. */

        /* Header */
        /* Comentario para el encabezado del slide. */
        .slide-header {
            /* Estilos del encabezado. */
            width: 100%;
            padding: 20px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 2;
            border-bottom: 3px solid var(--teal);
            background: rgba(255, 255, 255, 0.95);
            /* Ancho completo, relleno, flexbox para alinear elementos, borde inferior, fondo semi-transparente. */
        }

        .slide-title {
            font-size: 28px;
            color: var(--teal);
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Estilos del título principal del slide. */

        /* --- SLIDE 1: DASHBOARD --- */
        /* Comentario para los estilos del primer slide. */
        .dashboard-layout {
            display: grid;
            grid-template-columns: 320px 1fr;
            width: 100%;
            height: 100%;
            z-index: 2;
        }

        /* Grid de 2 columnas (sidebar fijo, contenido flexible). */
        .sidebar {
            background: linear-gradient(160deg, var(--teal), #003333);
            color: var(--white);
            padding: 40px 30px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* Estilos de la barra lateral (fondo degradado). */

        .custom-select {
            width: 100%;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            border-radius: 5px;
            font-family: inherit;
        }

        /* Estilos del selector de ciudad. */
        .custom-select option {
            background: #003333;
        }

        /* Estilos para las opciones dentro del selector. */

        .month-selector {
            display: flex;
            gap: 5px;
        }

        /* Contenedor de los botones de selección de mes. */
        .month-btn {
            flex: 1;
            padding: 8px;
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.5);
            color: white;
            cursor: pointer;
            border-radius: 4px;
        }

        /* Estilos de los botones de mes. */
        .month-btn.active {
            background: var(--white);
            color: var(--teal-dark);
            font-weight: bold;
        }

        /* Estilos para el botón de mes activo. */

        .salary-card {
            margin-top: auto;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--aqua);
            padding: 20px;
            text-align: center;
            border-radius: 10px;
        }

        /* Tarjeta de salario base semanal. */
        .salary-val {
            font-size: 40px;
            font-weight: bold;
            display: block;
            margin: 10px 0;
        }

        /* Valor numérico del salario. */

        .content-grid {
            padding: 30px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 20px;
        }

        /* Grid de contenido principal (4 tarjetas). */
        .dash-card {
            border: 1px solid #eee;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.03);
            background: white;
        }

        /* Estilos de las tarjetas del dashboard. */
        .card-head {
            background: var(--mint-light);
            color: var(--teal);
            font-weight: bold;
            padding: 10px 15px;
            border-bottom: 1px solid #eee;
            font-size: 14px;
        }

        /* Encabezado de la tarjeta. */
        .card-body {
            padding: 15px;
            font-size: 13px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* Cuerpo de la tarjeta. */
        .info-table {
            width: 100%;
            border-collapse: collapse;
        }

        /* Tabla de información dentro de las tarjetas. */
        .info-table td {
            padding: 5px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        /* Celdas de la tabla. */
        .h-val {
            font-weight: bold;
            color: var(--teal-dark);
            font-size: 16px;
        }

        /* Valores destacados en la tabla. */

        .highlight-text-mty {
            font-size: 18px;
            color: var(--teal);
            font-weight: bold;
            line-height: 1.4;
            text-align: center;
        }

        /* Estilo especial para el recálculo en Monterrey. */

        /* --- SLIDE 2: PROCESO --- */
        /* Comentario para los estilos del segundo slide. */
        .process-layout {
            padding: 40px 60px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            align-items: center;
            height: 100%;
            z-index: 2;
        }

        /* Grid de 2 columnas para el proceso. */
        .process-step {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }

        /* Contenedor de cada paso del proceso. */
        .p-icon {
            width: 45px;
            height: 45px;
            background: var(--mint-light);
            color: var(--teal);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            flex-shrink: 0;
        }

        /* Icono circular del paso. */
        .cuida-box {
            border: 2px dashed var(--teal);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-top: 20px;
        }

        /* Caja destacada (no usada en el HTML final, pero definida). */

        /* --- SLIDE 3: 4 CUADRANTES --- */
        /* Comentario para los estilos del tercer slide (calculadora). */
        /* FIX DE LAYOUT: Se ajusta el padding inferior para evitar la superposición con el total-bar */
        /* Comentario de ajuste de layout. */
        .quad-layout {
            /* Estilos del layout de 4 cuadrantes. */
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 20px;
            padding: 30px 50px 90px 50px;
            /* Incrementado de 30px a 90px para espacio del footer */
            /* Relleno con espacio extra abajo para la barra de total. */
            width: 100%;
            height: 100%;
            z-index: 2;
        }

        .quad-card {
            background: var(--white);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            border-top: 4px solid var(--teal);
        }

        /* Tarjeta de cada cuadrante. */
        .quad-title {
            font-weight: bold;
            color: var(--teal);
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }

        /* Título del cuadrante. */

        .q-input-row {
            display: flex;
            gap: 5px;
            margin-bottom: 5px;
            align-items: center;
        }

        /* Fila de entrada de datos (select, inputs, botón). */
        .q-select {
            flex: 2;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 11px;
        }

        /* Selector de producto. */
        .q-input-rent {
            flex: 1;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 11px;
            width: 80px;
        }

        /* Input manual de renta (para simples/empresarial). */
        .q-qty {
            width: 40px;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            text-align: center;
            font-size: 11px;
        }

        /* Input de cantidad. */
        .q-btn {
            background: var(--teal);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: 25px;
            height: 25px;
            font-weight: bold;
        }

        /* Botón de añadir (+). */

        .q-list {
            flex-grow: 1;
            overflow-y: auto;
            font-size: 11px;
            margin-bottom: 10px;
            border: 1px solid #eee;
            padding: 5px;
            height: 60px;
        }

        /* Lista de ítems añadidos. */
        .q-total {
            text-align: right;
            font-weight: bold;
            color: var(--teal-dark);
            border-top: 1px solid #eee;
            padding-top: 5px;
            font-size: 14px;
        }

        /* Total de comisiones del cuadrante. */

        .total-bar {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: var(--teal-dark);
            color: white;
            padding: 20px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
            font-size: 14px;
        }

        /* Barra inferior con el total general. */
        .retention-text {
            color: var(--red-retention);
            font-size: 16px;
            font-weight: bold;
            margin-left: 15px;
            background: rgba(255, 255, 255, 0.9);
            padding: 2px 8px;
            border-radius: 4px;
        }

        /* Estilo para destacar la retención/chargeback. */

        /* --- SLIDE 4: MENSUAL REALISTA --- */
        /* Comentario para los estilos del cuarto slide. */
        .monthly-layout {
            padding: 30px 50px;
            z-index: 2;
            width: 100%;
            height: 100%;
            display: grid;
            grid-template-rows: auto 1fr;
            gap: 20px;
        }

        /* Layout del escenario mensual. */
        .m-grid-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
        }

        /* Grid para los 5 inputs de ventas. */
        .m-card {
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.05);
            text-align: center;
            border: 1px solid #eee;
        }

        /* Tarjeta de input de cantidad de ventas. */
        .m-card h4 {
            margin: 0 0 8px 0;
            font-size: 11px;
            color: var(--teal);
        }

        /* Título de la tarjeta de input. */
        .m-card input {
            width: 100%;
            padding: 5px;
            text-align: center;
            border: 1px solid var(--aqua);
            border-radius: 4px;
            font-weight: bold;
        }

        /* Input de número de ventas. */

        .final-summary {
            background: white;
            border: 1px solid #ddd;
            border-radius: 15px;
            padding: 25px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            align-items: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
        }

        /* Contenedor del resumen final. */
        .summary-list {
            list-style: none;
            padding: 0;
            margin: 0;
            width: 100%;
            font-size: 18px;
        }

        /* Lista de desglose de pagos. */
        .summary-list li {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px dashed #eee;
        }

        /* Elemento de la lista. */
        .summary-list li:last-child {
            border-bottom: none;
            font-weight: bold;
            font-size: 24px;
            margin-top: 15px;
            color: var(--teal-dark);
            border-top: 2px solid var(--teal);
            padding-top: 15px;
        }

        /* Estilo especial para el total final. */

        .retention-row {
            color: var(--red-retention);
            font-weight: bold;
            font-size: 20px;
        }

        /* Fila para el monto de retención/chargeback. */
    </style>
</head>

<body> <button class="download-btn" onclick="downloadHTML()"> <i class="fa-solid fa-download"></i> Descargar
        Presentación </button>

    <script> function downloadHTML() { // Función para descargar el código fuente HTML actual.
            const html = document.documentElement.outerHTML; // Obtiene el código HTML completo de la página.
            const blob = new Blob([html], { type: 'text/html' }); // Crea un objeto Blob con el código HTML.
            const url = URL.createObjectURL(blob); // Crea una URL temporal para el Blob.
            const a = document.createElement('a'); // Crea un elemento <a> temporal.
            a.href = url; a.download = 'Comisiones_Training_V18.html'; // Establece la URL y el nombre de archivo para la descarga.
            a.click(); // Simula un clic en el enlace para iniciar la descarga.
        }

        // --- DATA --- // Comentario de sección de datos.
        const CITIES = { // Objeto con la información de las ciudades y sus reglas.
            "CDMX": { region: "CENTRO", name: "Cd. México", base: 2000, type: "STD" }, // Datos para CDMX.
            "TOL": { region: "CENTRO", name: "Toluca", base: 2000, type: "STD" }, // Datos para Toluca.
            "MXL": { region: "BAJA", name: "Mexicali", base: 3000, type: "STD" }, // Datos para Mexicali.
            "ENS": { region: "BAJA", name: "Ensenada", base: 3000, type: "ENS" }, // Datos para Ensenada (Regla especial ENS).
            "TIJ": { region: "BAJA", name: "Tijuana", base: 2000, type: "STD" }, // Datos para Tijuana.
            "MTY": { region: "NORTE", name: "Monterrey", base: 2500, type: "MTY" }, // Datos para Monterrey (Regla especial MTY).
            "SAL": { region: "NORTE", name: "Saltillo", base: 2500, type: "MTY" }, // Datos para Saltillo (usa regla MTY).
            "GDL": { region: "PACIFICO", name: "Guadalajara", base: 2000, type: "GDL" }, // Datos para Guadalajara (Regla especial GDL).
            "PUE": { region: "SUR", name: "Puebla", base: 2000, type: "STD" }, // Datos para Puebla.
            "VER": { region: "SUR", name: "Veracruz", base: 2000, type: "STD" } // Datos para Veracruz.
        };

        const RULES = { // Objeto con las reglas de comisión por tipo de plaza.
            "STD": { w_quota: [1.5, 2, 2.5], m_quota: [6, 8, 10], f_plus: [1, 1.2, 1.5], recalc_desc: "Ajuste a Real" }, // Reglas Estándar (STD).
            "ENS": { w_quota: [1.5, 2, 2.5], m_quota: [999, 999, 999], f_plus: [0.5, 0.5, 0.5], recalc_desc: "NO APLICA" }, // Reglas Ensenada (ENS).
            "MTY": { // Reglas Monterrey (MTY).
                w_quota: [0.5, 0.5, 0.5], // Cuota semanal fija para MTY.
                m_quota: [10, 10, 10], // Meta mensual.
                f_plus: [0.5, 0.5, 0.5], // Factor Plus semanal fijo para MTY.
                recalc_desc: "10 Act: 1X (Exc. Básico)<br>18 Act: 1.5X (Exc. Básico)" // Descripción del recálculo.
            },
            "GDL": { w_quota: [2.0, 2.5, 3.0], m_quota: [8, 10, 12], f_plus: [1, 1.2, 1.5], recalc_desc: "Ajuste a Real" } // Reglas Guadalajara (GDL).
        };

        // LISTAS DE PLANES // Comentario de sección de productos.
        const PRODUCTS = { // Objeto que contiene las listas de productos por categoría.
            activations: [ // Productos de Activaciones (Masivo).
                { name: "Azul 1", rent: 266.99, type: "BASIC" }, // Ítem de Plan Básico.
                { name: "Azul 2", rent: 350.68, type: "PLUS" }, // Ítem de Plan Plus.
                { name: "Azul 3", rent: 442.75, type: "PLUS" }, // ...
                { name: "Black", rent: 668.73, type: "PLUS" }, // ...
                { name: "Oro", rent: 585.03, type: "PLUS" }, // ...
                { name: "Plata", rent: 526.44, type: "PLUS" }, // ...
                { name: "Diamante", rent: 1053.73, type: "PLUS" }, // ...
                { name: "Titanio", rent: 668.73, type: "PLUS" }, // ...
                { name: "Platino", rent: 836.12, type: "PLUS" }, // ...
                { name: "Lite 1", rent: 266.99, type: "BASIC" }, // Ítem de Plan Básico.
                { name: "Lite 2", rent: 350.68, type: "PLUS" }, // Ítem de Plan Plus.
                { name: "Lite 3", rent: 442.75, type: "PLUS" }, // ...
                { name: "Lite 4", rent: 526.44, type: "PLUS" }, // ...
                { name: "Lite 5", rent: 585.03, type: "PLUS" }, // ...
                { name: "Lite 6", rent: 836.12, type: "PLUS" }, // ...
                { name: "Lite 7", rent: 1212.75, type: "PLUS" } // ...
            ],
            renovations: [ // Productos de Renovaciones (Masivo).
                { name: "Azul 1", rent: 266.99, type: "BASIC" }, // Usan rentas y tipos similares, pero para el cuadrante 2.
                { name: "Azul 2", rent: 350.68, type: "PLUS" }, // ...
                { name: "Azul 3", rent: 442.75, type: "RENO" }, // Tipo específico para Renovaciones.
                { name: "Black", rent: 668.73, type: "RENO" }, // ...
                { name: "Oro", rent: 585.03, type: "RENO" }, // ...
                { name: "Plata", rent: 526.44, type: "RENO" }, // ...
                { name: "Diamante", rent: 1053.73, type: "RENO" }, // ...
                { name: "Titanio", rent: 668.73, type: "RENO" }, // ...
                { name: "Platino", rent: 836.12, type: "RENO" } // ...
            ],
            simples: [ // Productos de Planes Simples (Cuadrante C).
                { name: "Simple 12M", factor: 0.5, type: "SIMPLE" }, // Factor de comisión sobre la renta.
                { name: "Simple 18/24M", factor: 1.0, type: "SIMPLE" } // ...
            ],
            empresarial: [ // Productos Empresariales (Cuadrante D).
                { name: "Ármalo 12M (Act)", factor: 1.0, type: "B2B_STD" }, // Tipo para B2B estándar.
                { name: "Ármalo 18/24M (Act)", factor: 1.5, type: "B2B_STD" }, // Factor mayor para plazos más largos.
                { name: "Simple Neg 12M", factor: 1.0, type: "SIMPLE" }, // Plan Simple Negocio.
                { name: "Simple Neg 24M", factor: 2.0, type: "SIMPLE" } // ...
            ]
        };

        let state = { city: 'CDMX', month: 1, q1: [], q2: [], q3: [], q4: [] }; // Objeto global para almacenar el estado de la aplicación.
        // city: ciudad seleccionada. month: mes de training. q1-q4: arrays para los productos añadidos en cada cuadrante.

        // --- INIT --- // Comentario de sección de inicialización.
        function init() { // Función que se ejecuta al cargar la página.
            const sel = document.getElementById('citySelect'); // Obtiene el selector de ciudad.
            for (let k in CITIES) { // Itera sobre las claves (códigos) de las ciudades.
                let opt = document.createElement('option'); // Crea un nuevo elemento <option>.
                opt.value = k; opt.innerText = CITIES[k].name; // Asigna el valor (código) y el texto (nombre).
                sel.appendChild(opt); // Agrega la opción al selector.
            }
            fillSelect('sel_q1', PRODUCTS.activations); // Llama a la función para llenar el selector del cuadrante 1.
            fillSelect('sel_q2', PRODUCTS.renovations); // Llama a la función para llenar el selector del cuadrante 2.
            fillSelect('sel_q3', PRODUCTS.simples); // Llama a la función para llenar el selector del cuadrante 3.
            fillSelect('sel_q4', PRODUCTS.empresarial); // Llama a la función para llenar el selector del cuadrante 4.
            updateDash(); // Llama a la función para actualizar el dashboard inicial.
        }

        function fillSelect(id, arr) { // Función auxiliar para llenar un selector con opciones.
            const s = document.getElementById(id); // Obtiene el elemento select por ID.
            arr.forEach((item, idx) => { // Itera sobre el array de productos.
                let o = document.createElement('option'); // Crea el elemento option.
                o.value = idx; o.innerText = item.name; // Asigna el índice y el nombre del producto.
                s.appendChild(o); // Agrega la opción al selector.
            });
        }

        function setMonth(m) { // Función para cambiar el mes de training.
            state.month = m; // Actualiza el mes en el estado.
            document.querySelectorAll('.month-btn').forEach((b, i) => b.classList.toggle('active', i + 1 === m)); // Alterna la clase 'active' en los botones de mes.
            updateDash(); // Actualiza el dashboard con las nuevas reglas del mes.
        }

        function updateDash() { // Función principal para actualizar la interfaz del dashboard.
            state.city = document.getElementById('citySelect').value; // Obtiene la ciudad seleccionada.
            const info = CITIES[state.city]; // Obtiene los datos de la ciudad.
            const rules = RULES[info.type]; // Obtiene las reglas de comisión según el tipo de plaza.
            const mIdx = state.month - 1; // Calcula el índice del mes (0, 1, o 2).

            // Slide 1 UI // Actualización de la UI del Slide 1.
            document.getElementById('ui_base').innerText = "$" + info.base.toLocaleString(); // Muestra el sueldo base semanal.
            document.getElementById('ui_w_quota').innerText = rules.w_quota[mIdx]; // Muestra la cuota semanal.
            document.getElementById('ui_f_plus').innerText = rules.f_plus[mIdx] + "x"; // Muestra el factor Plus semanal.

            const rText = document.getElementById('ui_recalc_txt'); // Obtiene el elemento para el texto de recálculo.
            if (info.type === 'MTY') { // Condicional para la lógica especial de Monterrey.
                rText.innerHTML = rules.recalc_desc; // Establece el texto especial para MTY.
                rText.className = "highlight-text-mty"; // Aplica el estilo especial.
            } else { // Lógica para el resto de ciudades (STD, GDL, ENS).
                let mQuotaVal = (rules.m_quota[mIdx] > 100 ? "N/A" : rules.m_quota[mIdx] + " Act."); // Formatea la meta mensual (N/A si es 999/ENS).
                rText.innerHTML = `<div style="font-size:16px; font-weight:bold; color:var(--teal-dark); margin-bottom:5px;">Meta: ${mQuotaVal}</div><div style="font-size:12px; color:#666;">${rules.recalc_desc}</div>`; // Muestra la meta y la descripción.
                rText.className = ""; // Quita el estilo especial de MTY.
            }

            document.querySelectorAll('.disp-city').forEach(e => e.innerText = info.name); // Muestra el nombre de la ciudad en todos los elementos con la clase 'disp-city'.

            recalcQuadrants(); // Llama a la función para recalcular el Slide 3.
            recalcMonthly(); // Llama a la función para recalcular el Slide 4.
        }

        // --- SLIDE 3 --- // Comentario de sección del Slide 3 (Calculadora).
        function addQuad(qNum) { // Función para añadir un ítem a un cuadrante.
            const sel = document.getElementById(`sel_q${qNum}`); // Selector de producto.
            const qty = parseInt(document.getElementById(`qty_q${qNum}`).value) || 1; // Cantidad a añadir.
            let itemIndex = sel.value; // Índice del producto seleccionado.
            let list; // Variable para almacenar la lista de productos de origen.

            if (qNum === 1) list = PRODUCTS.activations; // Si es cuadrante 1 (Activaciones).
            else if (qNum === 2) list = PRODUCTS.renovations; // Si es cuadrante 2 (Renovaciones).
            else if (qNum === 3) list = PRODUCTS.simples; // Si es cuadrante 3 (Simples).
            else list = PRODUCTS.empresarial; // Si es cuadrante 4 (Empresarial).

            let template = list[itemIndex]; // Obtiene la plantilla del producto seleccionado.

            // Manual renta de gestión for C and D // Comentario para renta manual.
            let finalRent = template.rent; // Inicializa la renta con el valor de la plantilla.
            if (qNum >= 3) { // Si es cuadrante 3 o 4 (Simples o Empresarial).
                finalRent = parseFloat(document.getElementById(`rent_q${qNum}`).value) || 0; // Obtiene la renta manual ingresada.
            }

            let item = { ...template, rent: finalRent }; // Crea el ítem final con la renta potencialmente modificada.
            for (let i = 0; i < qty; i++) state[`q${qNum}`].push(item); // Añade el ítem `qty` veces al array de estado correspondiente.
            recalcQuadrants(); // Recalcula los totales y actualiza la interfaz.
        }

        // --- NUEVA FUNCIÓN: Eliminar elemento individual --- // Comentario para la nueva función de eliminar.
        function removeItem(qNum, index) { // Función para eliminar un ítem específico de un cuadrante.
            // Elimina 1 elemento en la posición 'index' del arreglo correspondiente // Comentario de la lógica.
            state[`q${qNum}`].splice(index, 1); // Elimina el elemento en la posición `index` del array `qN`.
            recalcQuadrants(); // Recalcula los totales.
        }

        function clearQuad(qNum) { state[`q${qNum}`] = []; recalcQuadrants(); } // Función para limpiar todos los ítems de un cuadrante.

        function recalcQuadrants() { // Función principal para recalcular todos los cuadrantes del Slide 3.
            const info = CITIES[state.city]; // Datos de la ciudad.
            const rules = RULES[info.type]; // Reglas de comisión.
            const mIdx = state.month - 1; // Índice del mes.

            let grandTotal = 0; // Inicializa el total de comisiones.
            let totalRetention = 0; // Inicializa el total de retención (chargeback).

            function processList(qNum, list) { // Función interna para procesar la lista de un cuadrante.
                let total = 0; // Total de comisiones del cuadrante.
                let html = ""; // String para construir el HTML de la lista.
                // Agregamos 'idx' para saber la posición del elemento // Comentario para el índice.
                list.forEach((p, idx) => { // Itera sobre la lista de productos del cuadrante.
                    let comm = 0; // Inicializa la comisión del producto.
                    if (qNum === 1) { // Lógica para Activaciones (Cuadrante A).
                        let factor = (p.type === 'BASIC') ? 0.5 : rules.f_plus[mIdx]; // Factor 0.5 para BASIC, Factor Plus para PLUS.
                        if (info.type === 'MTY') factor = 0.5; // Factor semanal fijo de 0.5x para MTY.
                        comm = p.rent * factor; // Comisión = Renta * Factor.
                    } else if (qNum === 2) { // Lógica para Renovaciones (Cuadrante B).
                        comm = p.rent * 1.0; // Comisión = Renta * 1.0 (factor fijo).
                    } else if (qNum >= 3) { // Lógica para Simples/B2B (Cuadrantes C y D).
                        comm = p.rent * p.factor; // Comisión = Renta * Factor específico del producto.
                    }

                    if (p.type && !p.type.includes("SIMPLE")) { // Condición para aplicar retención (Chargeback).
                        totalRetention += (comm * 0.15); // Suma el 15% de retención.
                    }

                    total += comm; // Suma la comisión al total del cuadrante.
                    // HTML modificado para incluir botón de borrar // Comentario.
                    html += `
                <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px dashed #eee; padding:2px 0;">
                    <span>${p.name}: $${comm.toFixed(0)}</span>
                    <i class="fa-solid fa-trash" 
                       style="cursor:pointer; color:var(--teal); margin-left:5px; font-size:10px;" 
                       title="Eliminar este ítem"
                       onclick="removeItem(${qNum}, ${idx})">
                    </i>
                </div>`; // Construye el HTML con el nombre, comisión y botón de eliminar.
                });
                document.getElementById(`list_q${qNum}`).innerHTML = html; // Inserta la lista HTML.
                document.getElementById(`tot_q${qNum}`).innerText = "$" + total.toFixed(0); // Muestra el total del cuadrante.
                return total; // Retorna el total del cuadrante.
            }

            grandTotal += processList(1, state.q1); // Procesa Cuadrante 1.
            grandTotal += processList(2, state.q2); // Procesa Cuadrante 2.
            grandTotal += processList(3, state.q3); // Procesa Cuadrante 3.
            grandTotal += processList(4, state.q4); // Procesa Cuadrante 4.

            let finalPay = info.base + grandTotal - totalRetention; // Calcula el pago final (Base + Comisiones - Retención).

            let footerHTML = `
            <span>Base: $${info.base} + Comisiones: $${grandTotal.toFixed(0)} 
            <span class="retention-text"> - Chargeback 15%: $${totalRetention.toFixed(0)}</span></span>
            <span style="font-size:24px; font-weight:bold;">Total a Pagar: $${finalPay.toLocaleString()}</span>
        `; // Construye el HTML de la barra inferior de totales.
            document.getElementById('total_bar_content').innerHTML = footerHTML; // Inserta el resumen en la barra.
        }

        // --- SLIDE 4 --- // Comentario de sección del Slide 4 (Escenario Mensual).
        function recalcMonthly() { // Función para recalcular el escenario mensual realista.
            const info = CITIES[state.city]; // Datos de la ciudad.
            const rules = RULES[info.type]; // Reglas de comisión.
            const mIdx = state.month - 1; // Índice del mes.

            let n_act_basic = parseInt(document.getElementById('in_act_basic').value) || 0; // Obtiene Activaciones Básicas.
            let n_act_plus = parseInt(document.getElementById('in_act_plus').value) || 0; // Obtiene Activaciones Plus.
            let n_reno_mass = parseInt(document.getElementById('in_reno_mass').value) || 0; // Obtiene Renovaciones Masivas.
            let n_simple = parseInt(document.getElementById('in_simple').value) || 0; // Obtiene Planes Simples.
            let n_b2b_std = parseInt(document.getElementById('in_b2b_std').value) || 0; // Obtiene Empresariales.

            let r_bas = 266; let r_plu = 450; let r_ren = 500; let r_simp = 250; let r_b2b = 417; // Rentas promedio/estimadas para el cálculo.

            let f_wk_plus = (info.type === 'MTY' || info.type === 'ENS') ? 0.5 : rules.f_plus[mIdx]; // Factor Plus Semanal (0.5x fijo para MTY/ENS).

            let comm_act_basic = n_act_basic * r_bas * 0.5; // Comisión Básica (Renta * 0.5).
            let comm_act_plus = n_act_plus * r_plu * f_wk_plus; // Comisión Plus (Renta * Factor Semanal).
            let comm_reno = n_reno_mass * r_ren * 1.0; // Comisión Renovación (Renta * 1.0).
            let comm_simple = n_simple * r_simp * 1.0; // Comisión Simple (Renta * 1.0).
            let comm_b2b = n_b2b_std * r_b2b * 1.5; // Comisión Empresarial (Renta * 1.5).

            let total_anticipo = comm_act_basic + comm_act_plus + comm_reno + comm_simple + comm_b2b; // Suma de todas las comisiones anticipadas (semanales).

            let bonus = 0; // Inicializa el bono de recálculo mensual.
            let total_activations_quota = n_act_basic + n_act_plus; // Total de activaciones para la meta.
            let quota = rules.m_quota[mIdx]; // Meta mensual de activaciones.

            if (info.type === 'MTY') { // Lógica de Bono/Recálculo para Monterrey.
                let target_factor = 0.5; // Factor objetivo inicial.
                if (total_activations_quota >= 18) target_factor = 1.5; // Meta de 18 activaciones.
                else if (total_activations_quota >= 10) target_factor = 1.0; // Meta de 10 activaciones.

                let target_pay_plus = n_act_plus * r_plu * target_factor; // Pago total que debería recibir por Act. Plus según la meta.
                let paid_pay_plus = n_act_plus * r_plu * 0.5; // Pago ya recibido (anticipado) por Act. Plus (Factor MTY fijo).
                bonus += (target_pay_plus - paid_pay_plus); // El bono es la diferencia (ajuste).

            } else if (info.type !== 'ENS') { // Lógica de Bono/Recálculo para STD y GDL (excluye ENS).
                if (total_activations_quota >= quota) { // Si se cumple la meta mensual.
                    let target_comm_acts = (n_act_basic * r_bas * 1.0) + (n_act_plus * r_plu * 1.5); // Comisión objetivo (1.0x para Basic, 1.5x para Plus).
                    let paid_comm_acts = comm_act_basic + comm_act_plus; // Comisión ya pagada (anticipada).
                    bonus += (target_comm_acts - paid_comm_acts); // El bono es la diferencia (ajuste).
                }
            }

            if (n_reno_mass >= 10) bonus += (n_reno_mass * r_ren * 0.5); // Bono adicional por Renovaciones Masivas (0.5x si >10).
            if (bonus < 0) bonus = 0; // El bono nunca puede ser negativo (se evita un cargo).

            // Retention // Comentario de sección de retención.
            let subject_to_retention = (comm_act_basic + comm_act_plus + comm_reno + comm_b2b) + bonus; // Suma de comisiones y bonos sujetos a retención.
            let retention_amount = subject_to_retention * 0.15; // Cálculo del 15% de retención.

            let base_total = info.base * 4; // Cálculo del sueldo base total mensual (4 semanas).
            let grand_total = base_total + total_anticipo + bonus - retention_amount; // Cálculo del Gran Total a Pagar.

            document.getElementById('res_base_total').innerText = "$" + base_total.toLocaleString(); // Muestra el total de base.
            document.getElementById('res_anticipo').innerText = "$" + total_anticipo.toLocaleString(undefined, { maximumFractionDigits: 0 }); // Muestra el total de anticipos.
            document.getElementById('res_recalc').innerText = "$" + bonus.toLocaleString(undefined, { maximumFractionDigits: 0 }); // Muestra el bono/recálculo.
            document.getElementById('res_retention').innerText = "-$" + retention_amount.toLocaleString(undefined, { maximumFractionDigits: 0 }); // Muestra el monto de retención (en negativo).
            document.getElementById('res_grand_total').innerText = "$" + grand_total.toLocaleString(undefined, { maximumFractionDigits: 0 }); // Muestra el Gran Total.
        }

        window.onload = init; // Llama a la función 'init' cuando la ventana ha cargado completamente.
    </script>
    <div class="slide-container" id="slide1">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="slide-header"> <span class="slide-title">1. Dashboard: Comisiones Training</span> <i
                class="fa-solid fa-chart-line" style="font-size:24px; color:var(--teal);"></i> </div>
        <div class="dashboard-layout">
            <div class="sidebar">
                <h3 style="border-bottom:1px solid #aaa; padding-bottom:10px;">Configuración</h3> <label
                    style="font-size:11px; color:var(--mint-light);">CIUDAD / PLAZA</label> <select id="citySelect"
                    class="custom-select" onchange="updateDash()"></select> <label
                    style="font-size:11px; color:var(--mint-light); margin-top:15px;">MES TRAINING</label>
                <div class="month-selector"> <button class="month-btn active" onclick="setMonth(1)">1</button> <button
                        class="month-btn" onclick="setMonth(2)">2</button> <button class="month-btn"
                        onclick="setMonth(3)">3</button> </div>
                <div class="salary-card"> <span
                        style="font-size:10px; letter-spacing:1px; color:var(--mint-light);">BASE SEMANAL</span> <span
                        class="salary-val" id="ui_base">$0</span> </div>
            </div>
            <div class="content-grid">
                <div class="dash-card">
                    <div class="card-head">Metas Activación (Semana)</div>
                    <div class="card-body">
                        <table class="info-table">
                            <tr>
                                <td>Meta:</td>
                                <td class="h-val" id="ui_w_quota">--</td>
                            </tr>
                            <tr>
                                <td colspan="2" style="font-size:11px; color:#666;">Referencia liberación.</td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="dash-card">
                    <div class="card-head">Factores Activación</div>
                    <div class="card-body">
                        <table class="info-table">
                            <tr>
                                <td>Básico:</td>
                                <td class="h-val">0.5x</td>
                            </tr>
                            <tr>
                                <td>Plus:</td>
                                <td class="h-val" id="ui_f_plus">--</td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="dash-card">
                    <div class="card-head">Recálculo Mensual</div>
                    <div class="card-body">
                        <div id="ui_recalc_txt" style="white-space: pre-wrap; text-align: center;"></div>
                    </div>
                </div>
                <div class="dash-card">
                    <div class="card-head">Renovaciones Masivo</div>
                    <div class="card-body">
                        <table class="info-table">
                            <tr>
                                <td>Semanal:</td>
                                <td class="h-val">1.0x</td>
                            </tr>
                            <tr>
                                <td>Mensual:</td>
                                <td class="h-val">1.5x (Si >10)</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="slide-container" id="slide2">
        <div class="slide-header"> <span class="slide-title">2. Proceso y Calidad</span> </div>
        <div class="process-layout" style="margin-left:-50px;">
            <div>
                <div class="process-step">
                    <div class="p-icon"><i class="fa-solid fa-calendar-check"></i></div>
                    <div>
                        <h3>Semana Vencida</h3>
                        <p>Las ventas de Lunes a Domingo se pagan la siguiente semana. Tu base se paga siempre.</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="p-icon"><i class="fa-solid fa-filter"></i></div>
                    <div>
                        <h3>Prospectación</h3>
                        <p>Mes 2 y 3 aumentan la cuota. Mantén tu funnel lleno desde el inicio.</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="p-icon"><i class="fa-solid fa-graduation-cap"></i></div>
                    <div>
                        <h3>Oferta Integral</h3>
                        <p>Maximiza ganancias con Renovaciones, Planes Simples y Empresariales.</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="p-icon"><i class="fa-solid fa-clock-rotate-left"></i></div>
                    <div>
                        <h3>Retención del Chargeback</h3>
                        <p>Se aplica en las ventas de activaciones y renovaciones Basicos y Plus tanto AVS Masivo como
                            AVS Empresarial.</p>
                    </div>
                </div>
            </div>
            <div style="text-align:center; margin-left:-15px;"> <img src="IMG/img_cuida.png" alt="C.U.I.D.A"
                    style="width: 1050px; max-width: 105%; border-radius: 10px;"> </div>
        </div>
    </div>

    <div class="slide-container" id="slide3">
        <div class="slide-header"> <span class="slide-title">3. Calculadora Multiproducto</span>
            <div style="font-size:14px;">Plaza: <span class="disp-city" style="font-weight:bold;">--</span></div>
        </div>
        <div class="quad-layout">
            <div class="quad-card">
                <div class="quad-title">A) Activaciones Masivo</div>
                <div class="q-input-row"> <select id="sel_q1" class="q-select"></select> <input type="number"
                        id="qty_q1" class="q-qty" value="1"> <button class="q-btn" onclick="addQuad(1)">+</button>
                </div>
                <div class="q-list" id="list_q1"></div>
                <div class="q-total" id="tot_q1">$0</div> <button onclick="clearQuad(1)"
                    style="font-size:10px; border:none; color:red; cursor:pointer;">Limpiar todo</button>
            </div>
            <div class="quad-card">
                <div class="quad-title">B) Renovaciones Masivo</div>
                <div class="q-input-row">
                    <select id="sel_q2" class="q-select"></select>
                    <input type="number" id="qty_q2" class="q-qty" value="1">
                    <button class="q-btn" onclick="addQuad(2)">+</button>
                </div>
                <div class="q-list" id="list_q2"></div>
                <div class="q-total" id="tot_q2">$0</div>
                <button onclick="clearQuad(2)" style="font-size:10px; border:none; color:red; cursor:pointer;">Limpiar
                    todo</button>
            </div>
            <div class="quad-card">
                <div class="quad-title">C) Planes Simples</div>
                <div class="q-input-row">
                    <select id="sel_q3" class="q-select"></select>
                    <input type="number" id="rent_q3" class="q-input-rent" placeholder="Renta" value="250"> <input
                        type="number" id="qty_q3" class="q-qty" value="1">
                    <button class="q-btn" onclick="addQuad(3)">+</button>
                </div>
                <div class="q-list" id="list_q3"></div>
                <div class="q-total" id="tot_q3">$0</div>
                <button onclick="clearQuad(3)" style="font-size:10px; border:none; color:red; cursor:pointer;">Limpiar
                    todo</button>
            </div>
            <div class="quad-card">
                <div class="quad-title">D) Empresarial</div>
                <div class="q-input-row">
                    <select id="sel_q4" class="q-select"></select>
                    <input type="number" id="rent_q4" class="q-input-rent" placeholder="Renta" value="417"> <input
                        type="number" id="qty_q4" class="q-qty" value="1">
                    <button class="q-btn" onclick="addQuad(4)">+</button>
                </div>
                <div class="q-list" id="list_q4"></div>
                <div class="q-total" id="tot_q4">$0</div>
                <button onclick="clearQuad(4)" style="font-size:10px; border:none; color:red; cursor:pointer;">Limpiar
                    todo</button>
            </div>
        </div>
        <div class="total-bar" id="total_bar_content">Resumen...</div>
    </div>

    <div class="slide-container" id="slide4">
        <div class="slide-header"> <span class="slide-title">4. Escenario Mensual Real</span>
            <div style="font-size:14px;">Plaza: <span class="disp-city" style="font-weight:bold;">--</span></div>
        </div>
        <div class="monthly-layout">
            <div class="m-grid-container">
                <div class="m-card">
                    <h4>Act. Básicas</h4><input type="number" id="in_act_basic" value="6" onchange="recalcMonthly()">
                </div>
                <div class="m-card">
                    <h4>Act. Plus</h4><input type="number" id="in_act_plus" value="4" onchange="recalcMonthly()">
                </div>
                <div class="m-card">
                    <h4>Reno Masivo</h4><input type="number" id="in_reno_mass" value="10" onchange="recalcMonthly()">
                </div>
                <div class="m-card">
                    <h4>Simple (Mass)</h4><input type="number" id="in_simple" value="2" onchange="recalcMonthly()">
                </div>
                <div class="m-card">
                    <h4>Empresarial</h4><input type="number" id="in_b2b_std" value="1" onchange="recalcMonthly()">
                </div>
            </div>
            <div class="final-summary">
                <div>
                    <h3 style="color:var(--teal);">Desglose Final</h3>
                    <p style="font-size:12px; color:#666;">Base + Comisiones + Bonos</p>
                </div>
                <ul class="summary-list">
                    <li><span>(+) Base Semanal (4sems)</span> <span id="res_base_total">$0</span></li>
                    <li><span>(+) Comisiones Anticipadas</span> <span id="res_anticipo">$0</span></li>
                    <li><span>(+) Recálculo Mes</span> <span id="res_recalc" style="color:var(--aqua);">$0</span></li>
                    <li class="retention-row"><span>(-) Retención 15%</span> <span id="res_retention">-$0</span></li>
                    <li><span>(=) GRAN TOTAL</span> <span id="res_grand_total">$0</span></li>
                </ul>
            </div>
        </div>
    </div>

</body>

</html>
